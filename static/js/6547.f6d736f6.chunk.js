"use strict";(self.webpackChunkmmsp_tbm=self.webpackChunkmmsp_tbm||[]).push([[6547],{56547:(t,r,e)=>{e.r(r),e.d(r,{default:()=>d});var a=e(63780),n=e(18722),u=e(68700),f=e(50894),o=e(32035),s=e(93311),i=e(78952),l=e(50628),b=e(74432),m=e(89414);class p{transform(t){const r=this._transform(t),e=[r.points.buffer,r.rgb.buffer];null!=r.pointIdFilterMap&&e.push(r.pointIdFilterMap.buffer);for(const a of r.attributes)"buffer"in a.values&&(0,n.eP)(a.values.buffer)&&a.values.buffer!==r.rgb.buffer&&e.push(a.values.buffer);return Promise.resolve({result:r,transferList:e})}_transform(t){const r=(0,b.Ym)(t.schema,t.geometryBuffer);let e=r.length/3,n=null;const u=new Array,f=(0,b.dH)(t.primaryAttributeData,r,e);null!=t.primaryAttributeData&&f&&u.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:f});const o=(0,b.dH)(t.modulationAttributeData,r,e);null!=t.modulationAttributeData&&o&&u.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:o});let s=(0,b.aE)(t.rendererInfo,f,o,e);if(t.filterInfo&&t.filterInfo.length>0&&null!=t.filterAttributesData){const f=t.filterAttributesData.filter(a.pC).map((t=>{const a=(0,b.dH)(t,r,e),n={attributeInfo:t.attributeInfo,values:a};return u.push(n),n}));n=new Uint32Array(e),e=(0,b.hv)(r,s,n,t.filterInfo,f)}for(const a of t.userAttributesData){const t=(0,b.dH)(a,r,e);u.push({attributeInfo:a.attributeInfo,values:t})}3*e<s.length&&(s=new Uint8Array(s.buffer.slice(0,3*e))),function(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}(r,e,t.elevationOffset);const l=c(r,e,m.Oo.fromData(t.obbData),i.Z.fromJSON(t.inSR),i.Z.fromJSON(t.outSR));return{obbData:t.obbData,points:l,rgb:s,attributes:u,pointIdFilterMap:n}}}function c(t,r,e,a,n){if(!(0,l.projectBuffer)(t,a,0,t,n,0,r))throw new Error("Can't reproject");const f=(0,s.d9)(e.center),i=(0,s.Ue)(),b=(0,s.Ue)(),m=(0,s.d9)(e.halfSize);(0,u.Kx)(h,e.quaternion);const p=new Float32Array(3*r);for(let u=0;u<r;u++){let r=3*u;i[0]=t[r]-f[0],i[1]=t[r+1]-f[1],i[2]=t[r+2]-f[2],(0,o.u)(b,i,h),m[0]=Math.max(m[0],Math.abs(b[0])),m[1]=Math.max(m[1],Math.abs(b[1])),m[2]=Math.max(m[2],Math.abs(b[2])),p[r++]=i[0],p[r++]=i[1],p[r]=i[2]}return e.halfSize=m,p}const h=(0,f.Ue)();function d(){return new p}}}]);
//# sourceMappingURL=6547.f6d736f6.chunk.js.map